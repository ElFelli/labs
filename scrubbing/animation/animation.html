<!--
Copyright 2012 The Toolkitchen Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<!DOCTYPE html>
<html>
<head>
  <title>Animation</title>
  <script src="../../../toolkit/platform/platform.js"></script>
  <link rel="components" href="../../../toolkit/components/g-component.html">
  <link rel="components" href="g-animation.html">
</head>
<body>
  <my-app animation="shake">
    <g-animation type="seq" autoplay>
      <g-animation type="slideRight" duration="1" fillmode="forwards"></g-animation>
      <g-animation type="slideDown" duration="1" fillmode="forwards"></g-animation>
      <g-animation type="slideLeft" duration="1" fillmode="forwards"></g-animation>
      <g-animation type="slideUp" duration="1" fillmode="forwards"></g-animation>
    </g-animation>
  </my-app>

  <element name="my-app" attributes="animation">
    <template>
      <style>
        @host {
          display: block;
        }

        div {
          padding: 20px;
          background: orange;
          margin: 20px;
          border: 1px solid purple;
        }

        div:nth-of-type(2) {
          background: yellow;
        }
      </style>
      <div id="target1">Animatatronic!</div>
      <div id="target2">Shanimatatronic!</div>
      <g-animation type="{{animation}}" target="{{node}}" duration="2" easing="ease-in-out" autoplay></g-animation>
<!--  <g-animation type="seq" target="{{$.target1}}" autoplay>
        <g-animation type="fadeout" duration="3"></g-animation>
        <g-animation type="fadein" duration="1"></g-animation>
      </g-animation>-->
<!--      <g-animation type="par" target="{{$.target2}}" autoplay>
        <g-animation type="seq">
          <g-animation type="fadeout" duration="2"></g-animation>
          <g-animation type="fadein" duration="2"></g-animation>
        </g-animation>
        <g-animation type="seq">
          <g-animation type="slideRight" duration="1" fillmode="forwards"></g-animation>
          <g-animation type="slideDown" duration="1" fillmode="forwards"></g-animation>
          <g-animation type="slideLeft" duration="1" fillmode="forwards"></g-animation>
          <g-animation type="slideUp" duration="1" fillmode="forwards"></g-animation>
        </g-animation>
      </g-animation>-->
    </template>
    <script>
      this.component && this.component({
        ready: function() {
          // this part is non-ideal.
          this.anim = document.createElement('g-animation');
          this.anim.addType('shake', {
            '-webkit-transform': [
              'translate3d(0,0,0)',
              'translate3d(-25px,0,0)',
              'translate3d(25px,0,0)',
              'translate3d(15px,0,0)',
              'translate3d(-15px,0,0)',
              'translate3d(5px,0,0)',
              'translate3d(-5px,0,0)',
              'translate3d(0,0,0)'
            ]
          });
          this.asyncMethod('setupUserAnimation');
        },
        findUserAnimation: function() {
          var children = ShadowDOM.localNodes(this.node);
          for (var i=0, c; c = children[i]; i++) {
            if (c.animation !== undefined) {
              return c;
            }
          }
        },
        setupUserAnimation: function() {
          this.userAnim = this.findUserAnimation();
          console.log(this.userAnim);
          if (this.userAnim) {
            this.userAnim.target = this.$.target2;
          }
        }
      });
    </script>
  </element>

<!-- potential use in something like overlay -->
<!-- easy mode: specify animation, play backwards when closing -->
<g-overlay animation="fade"></g-overlay>

<!-- easy mode: specify animation and closingAnimation -->
<g-overlay animation="fade" closingAnimation="shake"></g-overlay>


<!-- custom mode: for more complex animations, specify an animation component
which g-overlay will find and set itself as the target and use for opening/closing
-->
<g-overlay animation="fade">
  <g-animation class="animation"></g-animation>
</g-overlay>
</body>
</html>
