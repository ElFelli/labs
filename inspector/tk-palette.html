<!--
Copyright 2013 The Toolkitchen Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<element name="tk-palette">
  <template>
      <style>
        g-menu-item {
          display: block;
          padding: 14px 14px 14px 30px;
          cursor: pointer;
        }
        g-menu-item.selected {
          background-color: gray;
        }
        g-selector {
          display: block;
        }
      </style>
      <g-selector on-trackstart="trackStart" on-mousemove="move" on-track="track" on-trackend="trackEnd">
        <template repeat="{{metadata}}">
          <g-menu-item src="assets/ic_ribbon_labels_lightreg.png" tag="{{id}}" label="{{label}}"></g-menu-item>
        </template>
     </g-selector>
     <tk-elements-meta id="meta"></tk-elements-meta>
  </template>

  <script>
    Toolkit.register(this, {
      ready: function() {
        this.metadata = this.$.meta.metadata;
      },
      move: function(event) {
        this.mouse = {x: event.pageX, y: event.pageY};
      },
      trackStart: function(event) {
        this.startPoint = this.mouse;
        this.send('palette-drag-start', event.target.getAttribute('tag'));
        event.stopPropagation();
      },
      track: function(event) {
        var pt = {
          x: this.startPoint.x + event.dx, 
          y: this.startPoint.y + event.dy
        };
        this.send('palette-drag', pt);
        event.stopPropagation();
      },
      trackEnd: function(event) {
        this.send('palette-drag-end');
        event.stopPropagation();
      },
      getElementMeta: function(tag) {
        return this.$.meta.getElementMeta(tag);
      }
    });
  </script>
</element>
