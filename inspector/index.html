<!DOCTYPE html>
<!--
Copyright 2013 The Toolkitchen Authors. All rights reserved.
Use of this source code is governed by a BSD-style
license that can be found in the LICENSE file.
-->
<html>
  <head>
    <title></title>
    <meta charset="UTF-8">
<!--    <script src="http://toolkitchen.github.io/toolkit/toolkit.min.js"></script>-->
    <!--<script src="../../toolkit/toolkit.min.js"></script>-->
    <script src="../../toolkit/toolkit.js"></script>
    <link rel="import" href="../../toolkit/components/g-tabs.html">
    <link rel="import" href="../../toolkit/components/g-ratings.html">
    <link rel="import" href="../../toolkit/components/g-ribbon.html">
    <link rel="import" href="../../toolkit/components/g-togglebutton.html">
    <link rel="import" href="../../toolkit/components/g-toolbar.html">
    <link rel="import" href="tk-canvas.html">
    <link rel="import" href="tk-palette.html">
    <link rel="import" href="tk-inspector.html">
    <style>
      body, html {
        position: relative;
        height: 100%;
        margin: 0;
      }
      body {
        font-family: Arial;
        -webkit-user-select: none;
        background-color: whitesmoke;
      }
      tk-app {
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
      }
      g-ribbon {
        position: absolute;
        left: 0;
        width: 30%;
        top: 0;
        bottom: 0;
        background-color: white;
      }
      #canvas {
        position: absolute;
        left: 30%;
        right: 30%;
        top: 0;
        bottom: 0;
        background-color: white;
      }
      tk-inspector {
        position: absolute;
        right: 0;
        width: 30%;
        top: 0;
        bottom: 0;
        Xbackground-color: white;
      }
    </style>
  </head>
  <body>
    <tk-app></tk-app>
    
    <element name="tk-app" extends="g-app">
      <template>
        <tk-palette id="palette" on-palette-drag="paletteDrag"></tk-palette>
        <tk-canvas id="canvas" on-canvas-drop="canvasDrop" on-click="canvasClick">
          <g-tabs selected="0">
            <span>One</span>
            <span>Two</span>
            <span>Three</span>
            <span>Four</span>
          </g-tabs>
          <!-- 
          <g-ratings></g-ratings><br/>
          <x-test id="xtest" style="padding: 4px;" fill>Hello World</x-test>
          -->
        </tk-canvas>
      <tk-inspector id="inspector"></tk-inspector>
      </template>
      <script>
        Toolkit.register(this, {
          ready: function() {
            this.$.inspector.element = this.$.canvas.querySelector('g-tabs');
          },
          paletteDrag: function(event, detail) {
            console.log('paletteDrag:', detail);
            this.dragType = detail;
          },
          canvasDrop: function(event, detail) {
            if (this.dragType) {
              console.log('canvasDrop:', detail);
              var neo = document.createElement(this.dragType);
              neo.style.position = 'absolute';
              neo.style.left = detail.x + 'px';
              neo.style.top = detail.y + 'px';
              this.$.canvas.appendChild(neo);
              this.$.inspector.element = neo;
            } else {
              console.log('canvasDrop: inspect', event);
              this.inspectTarget(event);
            }
            this.dragType = null;
          },
          canvasClick: function(event) {
            this.inspectTarget(event);
          },
          inspectTarget: function(event) {
            var t = event.target;
            while (t && !t.isToolkitElement) {
              t = t.parentNode;
            }
            if (t && t !== inspector) {
              inspector.element = t;
            }
          }
        });
      </script>
    </element>

    <element name="x-test">
      <script>
        Toolkit.register(this, {
          fill: false,
          color: 'orange',
          fillChanged: function() {
            this.update();
          },
          colorChanged: function() {
            this.update();
          },
          update: function() {
            this.style.backgroundColor = this.fill ? this.color : '';
          }
        });
      </script>
    </element>
  </body>
</html>
