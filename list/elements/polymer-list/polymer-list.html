<link rel="import" href="polymer-virtual-list.html">

<polymer-element name="polymer-list" extends="polymer-virtual-list" attributes="data template">
  <!-- if list uses ShadowDOM -->
  <!-- <template>
    <content id="content"></content>
    <shadow></shadow>
  </template> -->
  <script>
    Polymer('polymer-list', {
      observe: {
        data: 'reset',
        template: 'updateTemplate'
      },
      createdCallback: function() {
        this.data = [];
        this.super();
      },
      ready: function() {
        this.updateTemplate();
        this.super();
      },
      reset: function() {
        if (this.data) {
          this.super([this.data.length]);
        }
      },
      updateTemplate: function() {
        var template = this.template || this.findTemplate();
        if (template != this._template) {
          this._template = template;
          this.reset();
        }
        if (!this.template) {
          this.onMutation(this, this.updateTemplate);
        }
      },
      findTemplate: function() {
        return this.querySelector('template');
        /*
        var $n = this.$.content.getDistributedNodes();
        for (var i=0, l=$n.length, n; (i<l) && (n=$n[i]); i++) {
          if (n.localName == 'template') {
            return n;
          }
        }
        */
      },
      generatePageContent: function(page, start, end) {
        this.super();
        var data = this.data.slice(start, end);
        if (data.length && this._template) {
          var template = this._template.ref || this._template;
          for (var i=0, l=data.length; i<l; i++) {
            page.appendChild(template.createInstance(data[i], this.syntax));
          }
        }
      }
    })
  </script>
</polymer-element>